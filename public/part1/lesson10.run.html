
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Lesson 10 Â· Boxes: Your Second Python Book</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Roberto Alsina">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="lesson11.run.html" />
    
    
    <link rel="prev" href="lesson9.run.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="finger_thinking.html">
            
                <a href="finger_thinking.html">
            
                    
                    Part 1: Finger Thinking
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="lesson0.run.html">
            
                <a href="lesson0.run.html">
            
                    
                    Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="lesson1.run.html">
            
                <a href="lesson1.run.html">
            
                    
                    Lesson 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="lesson2.run.html">
            
                <a href="lesson2.run.html">
            
                    
                    Lesson 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="lesson3.run.html">
            
                <a href="lesson3.run.html">
            
                    
                    Lesson 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="lesson4.run.html">
            
                <a href="lesson4.run.html">
            
                    
                    Lesson 4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="lesson5.run.html">
            
                <a href="lesson5.run.html">
            
                    
                    Lesson 5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="lesson6.run.html">
            
                <a href="lesson6.run.html">
            
                    
                    Lesson 6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="lesson7.run.html">
            
                <a href="lesson7.run.html">
            
                    
                    Lesson 7
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="lesson8.run.html">
            
                <a href="lesson8.run.html">
            
                    
                    Lesson 8
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="lesson9.run.html">
            
                <a href="lesson9.run.html">
            
                    
                    Lesson 9
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.11" data-path="lesson10.run.html">
            
                <a href="lesson10.run.html">
            
                    
                    Lesson 10
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="lesson11.run.html">
            
                <a href="lesson11.run.html">
            
                    
                    Lesson 11
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.13" data-path="recap.html">
            
                <a href="recap.html">
            
                    
                    Recapitulation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../part2/ducks_in_a_row.html">
            
                <a href="../part2/ducks_in_a_row.html">
            
                    
                    Part 2: Ducks in a Row
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../part2/lesson0.run.html">
            
                <a href="../part2/lesson0.run.html">
            
                    
                    Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../part2/lesson1.run.html">
            
                <a href="../part2/lesson1.run.html">
            
                    
                    Lesson 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../part2/lesson2.run.html">
            
                <a href="../part2/lesson2.run.html">
            
                    
                    Lesson 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../part2/lesson3.run.html">
            
                <a href="../part2/lesson3.run.html">
            
                    
                    Lesson 3
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../wax_on_wax_off.html">
            
                <a href="../wax_on_wax_off.html">
            
                    
                    Part 3: Wax On, Wax Off
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../going_public.html">
            
                <a href="../going_public.html">
            
                    
                    Part 4: Going Public
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../code.html">
            
                <a href="../code.html">
            
                    
                    Code Listings
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../original.run.html">
            
                <a href="../original.run.html">
            
                    
                    Original Code
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Lesson 10</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="boxes-v010">BOXES v0.10</h1>
<p>In our <a href="lesson9.run.html">previous lesson</a> we created a serviceable text
layout engine. It has many problems, but remember our goal is not to create
the best possible thing, this is an educational experience. The spit and
polish will appear later on.</p>
<p>But there is a glaring problem, it breaks words in all the wrong places.
Examples of it appear in almost every line of the output. So, how does one fix
that?</p>
<p>The traditional answer (and the one we will be using) is hyphenation, breaking
words between lines in the correct places.</p>
<p>Instead of breaking anywhere, we will break only in the places where the <a href="https://english.stackexchange.com/questions/385/what-are-the-rules-for-splitting-words-at-the-end-of-a-line" target="_blank">rules of each language</a>
allow us to.</p>
<p>Just as it happened with <a href="lesson7.run.html">text shaping</a> we are lucky to live
in a moment in time when almost everything we need to do it right is already
in place. In particular, we will use a library called <a href="https://github.com/Kozea/Pyphen" target="_blank">Pyphen</a>
mostly because I already have used it in another project.</p>
<p>Am I sure it&apos;s the best one? No. Do I know exactly how it does what it does?
No. I know enough to make it work, and it works <em>well enough</em> so for this
stage in the life of this project that is more than enough. In fact, it takes
the rules for word-breaking from dictionaries provided by an Office Suite, so
it does about as good a job as the dictionary does. It even supports
subtleties such as the differences between British and American English!</p>
<p>Here&apos;s an example of how it works:</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> pyphen
dic = pyphen.Pyphen(lang=<span class="hljs-string">&apos;en_GB&apos;</span>)
print(<span class="hljs-string">&apos;en_GB:&apos;</span>, dic.inserted(<span class="hljs-string">&apos;dictionary&apos;</span>, <span class="hljs-string">&apos;-&apos;</span>))
dic = pyphen.Pyphen(lang=<span class="hljs-string">&apos;en_US&apos;</span>)
print(<span class="hljs-string">&apos;en_US:&apos;</span>, dic.inserted(<span class="hljs-string">&apos;dictionary&apos;</span>, <span class="hljs-string">&apos;-&apos;</span>))
</code></pre>
<pre><code>en_GB: dic-tion-ary
en_US: dic-tio-nary
</code></pre><p>Keep in mind that this is not magic. If you feed it garbage, it will give you
garbage.</p>
<pre><code class="lang-python">dic = pyphen.Pyphen(lang=<span class="hljs-string">&apos;es_ES&apos;</span>)
print(<span class="hljs-string">&apos;es_ES:&apos;</span>, dic.inserted(<span class="hljs-string">&apos;dictionary&apos;</span>, <span class="hljs-string">&apos;-&apos;</span>))
</code></pre>
<pre><code>es_ES: dic-tio-na-ry
</code></pre><p>Where is it proper to break a line?</p>
<ul>
<li>On a newline character</li>
<li>On a space</li>
<li>On a breaking point as defined by Pyphen</li>
</ul>
<p>One of those things is not like the others. We have boxes with newlines in
them and we have boxes with spaces in them, but there are no boxes with
breaking points in them.</p>
<p>But we can add them! There is Unicode symbol for that:</p>
<blockquote>
<h3 id="soft-hyphen-shy">SOFT HYPHEN (SHY)</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Soft_hyphen" target="_blank">soft hyphen</a> serves as an
invisible marker used to specify a place in text where a hyphenated break
is allowed without forcing a line break in an inconvenient place if the
text is re-flowed. It becomes visible only after word wrapping at the end
of a line.</p>
</blockquote>
<p>So, if we insert them in all the right places, then we can use them to decide
whether we are at a suitable breaking point. We will put this in a file called
<code>hyphen.py</code></p>
<pre><code class="lang-python"><span class="hljs-comment"># hyphen.py</span>
<span class="hljs-keyword">import</span> pyphen

dic = pyphen.Pyphen(lang=<span class="hljs-string">&apos;en_US&apos;</span>)


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">insert_soft_hyphens</span><span class="hljs-params">(text, hyphen=<span class="hljs-string">&apos;\xad&apos;</span>)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;Insert the hyphen in breaking pointsaccording to the dictionary.

    &apos;\xad&apos; is the Soft Hyphen (SHY) character
    &quot;&quot;&quot;</span>
    lines = []
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> text.splitlines():
        hyph_words = [
            dic.inserted(word, hyphen) <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> line.split()
        ]
        lines.append(<span class="hljs-string">&apos; &apos;</span>.join(hyph_words))
    <span class="hljs-keyword">return</span> <span class="hljs-string">&apos;\n&apos;</span>.join(lines)
</code></pre>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> code.hyphen <span class="hljs-keyword">import</span> insert_soft_hyphens

<span class="hljs-keyword">print</span> (insert_soft_hyphens(<span class="hljs-string">&apos;Roses are red\nViolets are blue&apos;</span>, <span class="hljs-string">&apos;-&apos;</span>))
</code></pre>
<pre><code>Ros-es are red
Vi-o-lets are blue
</code></pre><p>So, with this code ready, we can get to work on implementing hyphenation
support in our layout function.</p>
<p>First, this code is exactly as it was before:</p>
<pre><code class="lang-python"><span class="hljs-comment"># lesson10.py</span>
<span class="hljs-keyword">from</span> code.fonts <span class="hljs-keyword">import</span> adjust_widths_by_letter
<span class="hljs-keyword">from</span> code.hyphen <span class="hljs-keyword">import</span> insert_soft_hyphens


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Box</span><span class="hljs-params">()</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, x=<span class="hljs-number">0</span>, y=<span class="hljs-number">0</span>, w=<span class="hljs-number">1</span>, h=<span class="hljs-number">1</span>, stretchy=False, letter=<span class="hljs-string">&apos;x&apos;</span>)</span>:</span>
        <span class="hljs-string">&quot;&quot;&quot;Accept arguments to define our box, and store them.&quot;&quot;&quot;</span>
        self.x = x
        self.y = y
        self.w = w
        self.h = h
        self.stretchy = stretchy
        self.letter = letter

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">&apos;Box(%s, %s, %s, %s, &quot;%s&quot;)&apos;</span> % (
            self.x, self.y, self.w, self.y, self.letter
        )
</code></pre>
<p>We do need to make a small change to how we load our text, to add the hyphens:</p>
<pre><code class="lang-python"><span class="hljs-comment"># lesson10.py</span>
p_and_p = open(<span class="hljs-string">&apos;pride-and-prejudice.txt&apos;</span>).read()
p_and_p = insert_soft_hyphens(p_and_p)  <span class="hljs-comment"># Insert invisible hyphens</span>
text_boxes = []
<span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> p_and_p:
    text_boxes.append(Box(letter=l, stretchy=l == <span class="hljs-string">&apos; &apos;</span>))
adjust_widths_by_letter(text_boxes)

<span class="hljs-comment"># A few pages all the same size</span>
pages = [Box(i * <span class="hljs-number">35</span>, <span class="hljs-number">0</span>, <span class="hljs-number">30</span>, <span class="hljs-number">50</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>)]
</code></pre>
<p>No changes in how we draw things.</p>
<pre><code class="lang-python"><span class="hljs-comment"># lesson10.py</span>
<span class="hljs-keyword">import</span> svgwrite


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">draw_boxes</span><span class="hljs-params">(boxes, fname, size, hide_boxes=False)</span>:</span>
    dwg = svgwrite.Drawing(fname, profile=<span class="hljs-string">&apos;full&apos;</span>, size=size)
    <span class="hljs-comment"># Draw the pages</span>
    <span class="hljs-keyword">for</span> page <span class="hljs-keyword">in</span> pages:
        dwg.add(
            dwg.rect(
                insert=(page.x, page.y),
                size=(page.w, page.h),
                fill=<span class="hljs-string">&apos;lightblue&apos;</span>,
            )
        )
    <span class="hljs-comment"># Draw all the boxes</span>
    <span class="hljs-keyword">for</span> box <span class="hljs-keyword">in</span> boxes:
        <span class="hljs-comment"># The box color depends on its features</span>
        color = <span class="hljs-string">&apos;green&apos;</span> <span class="hljs-keyword">if</span> box.stretchy <span class="hljs-keyword">else</span> <span class="hljs-string">&apos;red&apos;</span>
        <span class="hljs-comment"># Make the colored boxes optional</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> hide_boxes:
            dwg.add(
                dwg.rect(
                    insert=(box.x, box.y),
                    size=(box.w, box.h),
                    fill=color,
                )
            )
        <span class="hljs-comment"># Display the letter in the box</span>
        <span class="hljs-keyword">if</span> box.letter:
            dwg.add(
                dwg.text(
                    box.letter,
                    insert=(box.x, box.y + box.h),
                    font_size=box.h,
                    font_family=<span class="hljs-string">&apos;Arial&apos;</span>,
                )
            )
    dwg.save()
</code></pre>
<p>And now our layout function. One first approach, which we will refine later,
is to simply refuse to break lines if we are not in a &quot;good&quot; place to break it.</p>
<p>Then, we inject a box with a visible hyphen in the line break, and that&apos;s it.</p>
<p>Here is the code to create a box with a hyphen:</p>
<pre><code class="lang-python"><span class="hljs-comment"># lesson10.py</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hyphenbox</span><span class="hljs-params">()</span>:</span>
    b = Box(letter=<span class="hljs-string">&apos;-&apos;</span>)
    adjust_widths_by_letter([b])
    <span class="hljs-keyword">return</span> b
</code></pre>
<p>And here finally, our layout supports hyphens:</p>
<pre><code class="lang-python"><span class="hljs-comment"># lesson10.py</span>
<span class="hljs-comment"># We add a &quot;separation&quot; constant so you can see the boxes individually</span>
separation = <span class="hljs-number">.05</span>


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">layout</span><span class="hljs-params">(_boxes)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;Layout boxes along pages.

    Keep in mind that this function modifies the boxes themselves, so
    you should be very careful about trying to call layout() more than once
    on the same boxes.

    Specifically, some spaces will become 0-width and not stretchy.
    &quot;&quot;&quot;</span>

    <span class="hljs-comment"># Because we modify the box list, we will work on a copy</span>
    boxes = _boxes[:]
    <span class="hljs-comment"># We start at page 0</span>
    page = <span class="hljs-number">0</span>
    <span class="hljs-comment"># The 1st box should be placed in the correct page</span>
    previous = boxes.pop(<span class="hljs-number">0</span>)
    previous.x = pages[page].x
    previous.y = pages[page].y
    row = []
    <span class="hljs-keyword">while</span> boxes:
        <span class="hljs-comment"># We take the new 1st box</span>
        box = boxes.pop(<span class="hljs-number">0</span>)
        <span class="hljs-comment"># And put it next to the other</span>
        box.x = previous.x + previous.w + separation
        <span class="hljs-comment"># At the same vertical location</span>
        box.y = previous.y

        <span class="hljs-comment"># Handle breaking on newlines</span>
        break_line = <span class="hljs-keyword">False</span>
        <span class="hljs-comment"># But if it&apos;s a newline</span>
        <span class="hljs-keyword">if</span> (box.letter == <span class="hljs-string">&apos;\n&apos;</span>):
            break_line = <span class="hljs-keyword">True</span>
            <span class="hljs-comment"># Newlines take no horizontal space ever</span>
            box.w = <span class="hljs-number">0</span>
            box.stretchy = <span class="hljs-keyword">False</span>

        <span class="hljs-comment"># Or if it&apos;s too far to the right, and is a</span>
        <span class="hljs-comment"># good place to break the line...</span>
        <span class="hljs-keyword">elif</span> (box.x + box.w) &gt; (
            pages[page].x + pages[page].w
        ) <span class="hljs-keyword">and</span> box.letter <span class="hljs-keyword">in</span> (
            <span class="hljs-string">&apos; &apos;</span>, <span class="hljs-string">&apos;\xad&apos;</span>
        ):
            <span class="hljs-keyword">if</span> box.letter == <span class="hljs-string">&apos;\xad&apos;</span>:
                <span class="hljs-comment"># Add a visible hyphen in the row</span>
                h_b = hyphenbox()
                h_b.x = previous.x + previous.w + separation
                h_b.y = previous.y
                _boxes.append(h_b)  <span class="hljs-comment"># So it&apos;s drawn</span>
                row.append(h_b)  <span class="hljs-comment"># So it&apos;s justified</span>
            break_line = <span class="hljs-keyword">True</span>
            <span class="hljs-comment"># We adjust the row</span>
            <span class="hljs-comment"># Remove all right-margin spaces</span>
            <span class="hljs-keyword">while</span> row[<span class="hljs-number">-1</span>].letter == <span class="hljs-string">&apos; &apos;</span>:
                row.pop()
            slack = (pages[page].x + pages[page].w) - (
                row[<span class="hljs-number">-1</span>].x + row[<span class="hljs-number">-1</span>].w
            )
            <span class="hljs-comment"># Get a list of all the ones that are stretchy</span>
            stretchies = [b <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> row <span class="hljs-keyword">if</span> b.stretchy]
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> stretchies:  <span class="hljs-comment"># Nothing stretches do as before.</span>
                bump = slack / len(row)
                <span class="hljs-comment"># The 1st box gets 0 bumps, the 2nd gets 1 and so on</span>
                <span class="hljs-keyword">for</span> i, b <span class="hljs-keyword">in</span> enumerate(row):
                    b.x += bump * i
            <span class="hljs-keyword">else</span>:
                bump = slack / len(stretchies)
                <span class="hljs-comment"># Each stretchy gets wider</span>
                <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> stretchies:
                    b.w += bump
                <span class="hljs-comment"># And we put each thing next to the previous one</span>
                <span class="hljs-keyword">for</span> j, b <span class="hljs-keyword">in</span> enumerate(row[<span class="hljs-number">1</span>:], <span class="hljs-number">1</span>):
                    b.x = row[j - <span class="hljs-number">1</span>].x + row[j - <span class="hljs-number">1</span>].w + separation


        <span class="hljs-keyword">if</span> break_line:
            <span class="hljs-comment"># We start a new row</span>
            row = []
            <span class="hljs-comment"># We go all the way left and a little down</span>
            box.x = pages[page].x
            box.y = previous.y + previous.h + separation

        <span class="hljs-comment"># But if we go too far down</span>
        <span class="hljs-keyword">if</span> box.y + box.h &gt; pages[page].y + pages[page].h:
            <span class="hljs-comment"># We go to the next page</span>
            page += <span class="hljs-number">1</span>
            <span class="hljs-comment"># And put the box at the top-left</span>
            box.x = pages[page].x
            box.y = pages[page].y

        <span class="hljs-comment"># Put the box in the row</span>
        row.append(box)

        <span class="hljs-comment"># Collapse all left-margin space</span>
        <span class="hljs-keyword">if</span> all(b.letter == <span class="hljs-string">&apos; &apos;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> row):
            box.w = <span class="hljs-number">0</span>
            box.stretchy = <span class="hljs-keyword">False</span>
            box.x = pages[page].x

        previous = box


layout(text_boxes)
</code></pre>
<pre><code class="lang-python"><span class="hljs-comment"># lesson10.py</span>
draw_boxes(text_boxes, <span class="hljs-string">&apos;lesson10.svg&apos;</span>, (<span class="hljs-number">30</span>, <span class="hljs-number">50</span>), hide_boxes=<span class="hljs-keyword">True</span>)
</code></pre>
<p><img src="part1/lesson10.svg" alt="lesson10.svg"></p>
<p>And there in &quot;proper-ty&quot; you can see it in action. Of course this is
a na&#xEF;ve implementation. What happens if you just can&apos;t break?</p>
<pre><code class="lang-python">many_boxes = [Box(letter=<span class="hljs-string">&apos;a&apos;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">200</span>)]
adjust_widths_by_letter(many_boxes)
layout(many_boxes)
draw_boxes(many_boxes, <span class="hljs-string">&apos;lesson10_lots_of_a.svg&apos;</span>, (<span class="hljs-number">35</span>, <span class="hljs-number">6</span>), hide_boxes=<span class="hljs-keyword">True</span>)
</code></pre>
<p><img src="part1/lesson10_lots_of_a.svg" alt="lesson10_lots_of_a.svg"></p>
<p>Since it can&apos;t break at all, it just goes on and on.</p>
<p>And there are other corner cases!</p>
<pre><code class="lang-python">many_boxes = [Box(letter=<span class="hljs-string">&apos;a&apos;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">200</span>)]
many_boxes[<span class="hljs-number">100</span>] = Box(letter=<span class="hljs-string">&apos; &apos;</span>, stretchy=<span class="hljs-keyword">True</span>)
adjust_widths_by_letter(many_boxes)
layout(many_boxes)
draw_boxes(many_boxes, <span class="hljs-string">&apos;lesson10_one_break.svg&apos;</span>, (<span class="hljs-number">35</span>, <span class="hljs-number">6</span>), hide_boxes=<span class="hljs-keyword">True</span>)
</code></pre>
<p><img src="part1/lesson10_one_break.svg" alt="lesson10_one_break.svg"></p>
<p>Because there is only one place to break the line, it then tries to
wedge 100 letter &quot;a&quot; where there is room for 54 (I counted!) and something interesting happens... the &quot;slack&quot; is negative!</p>
<p>Instead of stretching out a &quot;underfilled&quot; line, we are squeezing a &quot;overfilled&quot; one. Everything gets packed too tight, and the letters start
overlapping one another.</p>
<p>The lesson is that just because it works for the usual case it doesn&apos;t mean
it&apos;s <strong>done</strong>. Even in the case of words, it can happen that breaking points take a while to appear and our line becomes overfull.</p>
<p>We will tackle that problem next.</p>
<hr>
<p>Further references:</p>
<ul>
<li>Full source code for this lesson <a href="lesson10.py.run.html">lesson10.py</a></li>
<li><a href="part1/code/diffs/lesson9_lesson10.html">Difference with code from last lesson</a></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="lesson9.run.html" class="navigation navigation-prev " aria-label="Previous page: Lesson 9">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="lesson11.run.html" class="navigation navigation-next " aria-label="Next page: Lesson 11">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Lesson 10","level":"1.2.11","depth":2,"next":{"title":"Lesson 11","level":"1.2.12","depth":2,"path":"part1/lesson11.run.md","ref":"./part1/lesson11.run.md","articles":[]},"previous":{"title":"Lesson 9","level":"1.2.10","depth":2,"path":"part1/lesson9.run.md","ref":"part1/lesson9.run.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"root":"./src","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Roberto Alsina","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Boxes: Your Second Python Book","language":"en","gitbook":"*","description":"The full lifecycle of a project."},"file":{"path":"part1/lesson10.run.md","mtime":"2018-03-30T15:55:19.698Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-03-31T19:29:33.655Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

