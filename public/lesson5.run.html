<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Lesson 5 - </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">

        <!-- MathJax -->
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>
    </head>
    <body class="light">
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = localStorage.getItem('theme');
            if (theme == null) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = localStorage.getItem('sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li><a href="./lesson1.run.html"><strong>1.</strong> Lesson 1</a></li><li><a href="./lesson2.run.html"><strong>2.</strong> Lesson 2</a></li><li><a href="./lesson3.run.html"><strong>3.</strong> Lesson 3</a></li><li><a href="./lesson4.run.html"><strong>4.</strong> Lesson 4</a></li><li><a href="./lesson5.run.html" class="active"><strong>5.</strong> Lesson 5</a></li><li><a href="./lesson6.run.html"><strong>6.</strong> Lesson 6</a></li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush"></i>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <i id="print-button" class="fa fa-print" title="Print this book"></i>
                    </div>
                </div>

                <div id="content" class="content">
                    <a class="header" href="./lesson5.run.html#boxes-v5" id="boxes-v5"><h1>BOXES v5</h1></a>
<p>In our <a href="lesson.4.run.html">previous lesson</a> we created code that can fill a series of pages using many small boxes.</p>
<p>But only when those boxes are all alike. Once the boxes had different widths, the right side of our layout got all ragged. You surely have seen things like it when using word processors or reading web pages, where the text is all aligned on the left and all ragged on the right. It's called a &quot;left-aligned&quot; or &quot;ragged-right&quot; layout.</p>
<p>The reason is that we exceed the page width by a random amount, and then,
when moving that box to the next row, we are left a random amount <strong>short</strong> of the desired width.</p>
<p>Could we make it look aligned on BOTH sides? Of course. Let's try.</p>
<p>This code is just like before:</p>
<pre><code class="language-python">class Box():
    def __init__(self, x=0, y=0, w=1, h=1):
        &quot;&quot;&quot;We accept a few arguments to define our box, and we store them.&quot;&quot;&quot;
        self.x = x
        self.y = y
        self.w = w
        self.h = h

    def __repr__(self):
        &quot;&quot;&quot;This is what is shown if we print a Box. We want it to be useful.&quot;&quot;&quot;
        return 'Box(%s, %s, %s, %s)' % (self.x, self.y, self.w, self.y)

# Many boxes with varying widths
from random import randint
many_boxes = [Box(w=1 + randint(-5,5)/10) for i in range(5000)]
# A few pages all the same size
pages = [Box(i * 35, 5, 30, 50) for i in range(10)]
</code></pre>
<p>And of course, we need a new layout function. The plan is this:</p>
<ul>
<li>Organize boxes in rows, like before.</li>
<li>When we are about to go too wide, see how much &quot;slack&quot; is left
between the right side of our last box in the row and the edge of
the page.</li>
<li>Spread that slack by sliding all boxes slightly right so noone notices.</li>
</ul>
<pre><code class="language-python"># We add a &quot;separation&quot; constant so you can see the boxes individually
separation = .2

def layout(_boxes):
    # Because we modify the box list, we will work on a copy
    boxes = _boxes[:]
    # We start at page 0
    page = 0
    # The 1st box should be placed in the correct page
    previous = boxes.pop(0)
    previous.x = pages[page].x
    previous.y = pages[page].y
    row = []
    while boxes:
        # We take the new 1st box
        box = boxes.pop(0)
        # And put it next to the other
        box.x = previous.x + previous.w + separation
        # At the same vertical location
        box.y = previous.y
        # But if it's too far to the right...
        if (box.x + box.w) &gt; (pages[page].x + pages[page].w):
            # We adjust the row
            slack = (pages[page].x + pages[page].w) - (row[-1].x + row[-1].w)
            bump = slack / len(row)
            # The 1st box gets 0 bumps, the 2nd gets 1 and so on
            for i, b in enumerate(row):
                b.x += bump * i
            # We start a new row
            row = []
            # We go all the way left and a little down
            box.x = pages[page].x
            box.y = previous.y + previous.h + separation

        # But if we go too far down
        if box.y + box.h &gt; pages[page].y + pages[page].h:
            # We go to the next page
            page += 1
            # And put the box at the top-left
            box.x = pages[page].x
            box.y = pages[page].y

        # Put the box in the row
        row.append(box)
        previous = box

layout(many_boxes)
</code></pre>
<p>The drawing code needs no changes.</p>
<pre><code class="language-python">import svgwrite

def draw_boxes(boxes, name='lesson5.svg'):
    dwg = svgwrite.Drawing(name, profile='full', size=(150, 60))
    for page in pages:
        dwg.add(dwg.rect(insert=(page.x, page.y), 
                size=(page.w, page.h), fill='yellow'))
    for box in boxes:
        dwg.add(dwg.rect(insert=(box.x, box.y), size=(box.w, box.h), fill='red'))
    dwg.save()

draw_boxes(many_boxes)
</code></pre>
<p><img src="lesson5.svg" width="100%" style='border: 1px solid green; overflow: auto;'></p>
<p>Isn't that nice? If you look at it from afar it looks sort of familiar.
Doesn't it?</p>

                </div>

                <!-- Mobile navigation buttons -->
                
                    <a href="./lesson4.run.html" class="mobile-nav-chapters previous">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="./lesson6.run.html" class="mobile-nav-chapters next">
                        <i class="fa fa-angle-right"></i>
                    </a>
                

            </div>

            
                <a href="./lesson4.run.html" class="nav-chapters previous" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-left"></i>
                </a>
            

            
                <a href="./lesson6.run.html" class="nav-chapters next" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-right"></i>
                </a>
            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <!-- Livereload script (if served using the cli tool) -->
        

        <script src="highlight.js"></script>
        <script src="book.js"></script>
    </body>
</html>
