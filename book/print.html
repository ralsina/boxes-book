<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Lesson 6 - </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">

        <!-- MathJax -->
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>
    </head>
    <body class="light">
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = localStorage.getItem('theme');
            if (theme == null) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = localStorage.getItem('sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li><a href="./lesson1.run.html"><strong>1.</strong> Lesson 1</a></li><li><a href="./lesson2.run.html"><strong>2.</strong> Lesson 2</a></li><li><a href="./lesson3.run.html"><strong>3.</strong> Lesson 3</a></li><li><a href="./lesson4.run.html"><strong>4.</strong> Lesson 4</a></li><li><a href="./lesson5.run.html"><strong>5.</strong> Lesson 5</a></li><li><a href="./lesson6.run.html"><strong>6.</strong> Lesson 6</a></li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush"></i>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <i id="print-button" class="fa fa-print" title="Print this book"></i>
                    </div>
                </div>

                <div id="content" class="content">
                    <a class="header" href="print.html#boxes-v1" id="boxes-v1"><h1>BOXES v1</h1></a>
<p>Welcome to Boxes v1. I want to be able to draw some boxes. By boxes I don't mean actual boxes,
but rather squares. I found a library called svgwrite that lets you do that pretty easily.</p>
<p>First let's create a data structure. A simple class called Box.</p>
<pre><code class="language-python">class Box():
    def __init__(self, x=0, y=0, w=1, h=1):
        &quot;&quot;&quot;We accept a few arguments to define our box, and we store them.&quot;&quot;&quot;
        self.x = x
        self.y = y
        self.w = w
        self.h = h

    def __repr__(self):
        &quot;&quot;&quot;This is what is shown if we print a Box. We want it to be useful.&quot;&quot;&quot;
        return 'Box(%s, %s, %s, %s)' % (self.x, self.y, self.w, self.y)
</code></pre>
<p>As you can see that is a pretty simple class. And we can create a big box.</p>
<pre><code class="language-python">big_box = Box(0, 0, 80, 100)
</code></pre>
<p>Or many boxes using a <a href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions">list comprehension</a></p>
<pre><code class="language-python">many_boxes = [Box() for i in range(5000)]
</code></pre>
<p>So now we have a big box, and 5000 smaller boxes, all alike.</p>
<pre><code class="language-python"># Print the first 10 boxes
print(many_boxes[:10])
</code></pre>
<pre><code>[Box(0, 0, 1, 0), Box(0, 0, 1, 0), Box(0, 0, 1, 0), Box(0, 0, 1, 0), Box(0, 0, 1, 0), Box(0, 0, 1, 0), Box(0, 0, 1, 0), Box(0, 0, 1, 0), Box(0, 0, 1, 0), Box(0, 0, 1, 0)]
</code></pre>
<p>And yes, we can draw those boxes.</p>
<pre><code class="language-python">import svgwrite

def draw_boxes(boxes):
    dwg = svgwrite.Drawing('lesson1.svg', profile='full', size=(100, 100))
    for box in boxes:
        dwg.add(dwg.rect(insert=(box.x, box.y), size=(box.w, box.h), fill='red'))
    dwg.save()

draw_boxes(many_boxes)
</code></pre>
<p>And here is the output:</p>
<p><img src="lesson1.svg" width="100%" style='border: 1px solid green;'></p>
<p>That ... was not very interesting. It's a single small red square!</p>
<p>Remember <em>all our boxes have the same size and position!</em></p>
<p>So ... we should do something better. Or at least more interesting, in lesson 2.</p>
<a class="header" href="print.html#boxes-v2" id="boxes-v2"><h1>BOXES v2</h1></a>
<p>In our <a href="lesson1.run.html">previous lesson</a> we created a rather disappointing
drawing using boxes. Let's introduce a new wrinkle, and <strong>layout</strong> the many
boxes.</p>
<p>This code is just like before:</p>
<pre><code class="language-python">class Box():
    def __init__(self, x=0, y=0, w=1, h=1):
        &quot;&quot;&quot;We accept a few arguments to define our box, and we store them.&quot;&quot;&quot;
        self.x = x
        self.y = y
        self.w = w
        self.h = h

    def __repr__(self):
        &quot;&quot;&quot;This is what is shown if we print a Box. We want it to be useful.&quot;&quot;&quot;
        return 'Box(%s, %s, %s, %s)' % (self.x, self.y, self.w, self.y)

many_boxes = [Box() for i in range(5000)]
</code></pre>
<p>But now, so they are not all stuck one on top of the other, let's lay the boxes down in a line, one next to the other.</p>
<pre><code class="language-python"># We add a &quot;separation&quot; constant so you can see the boxes individually
separation = .2

def layout(boxes):
    for i, box in enumerate(boxes):
        box.x = i * (1 + separation)

layout(many_boxes)
</code></pre>
<p>And we can now see that they all have different coordinates now by printing
a few of them. And yes, some of those numbers do look funny. Floating point
numbers are weird.</p>
<pre><code class="language-python">print([(box.x, box.y) for box in many_boxes[:10]])
</code></pre>
<pre><code>[(0.0, 0), (1.2, 0), (2.4, 0), (3.5999999999999996, 0), (4.8, 0), (6.0, 0), (7.199999999999999, 0), (8.4, 0), (9.6, 0), (10.799999999999999, 0)]
</code></pre>
<p>Let's draw them!</p>
<pre><code class="language-python">import svgwrite

def draw_boxes(boxes):
    dwg = svgwrite.Drawing('lesson2.svg', profile='full', size=(100, 100))
    for box in boxes:
        dwg.add(dwg.rect(insert=(box.x, box.y), size=(box.w, box.h), fill='red'))
    dwg.save()

draw_boxes(many_boxes)
</code></pre>
<p>And here is the output:</p>
<p><img src="lesson2.svg" width="100%" style='border: 1px solid green; overflow: auto;'></p>
<p>That was more or less what we expected, right? Of course since there are 5000 small
boxes that row of boxes goes on for quite a while.</p>
<p>We <em>could</em> just go to the right for a while, then start a new row. Let's do that in
the next lesson.</p>
<a class="header" href="print.html#boxes-v3" id="boxes-v3"><h1>BOXES v3</h1></a>
<p>In our <a href="lesson2.run.html">previous lesson</a> we ended with something like a line
of army ants, all our boxes lined up. Let's make it better by making them
organize themselves in rows.</p>
<p>This code is just like before:</p>
<pre><code class="language-python">class Box():
    def __init__(self, x=0, y=0, w=1, h=1):
        &quot;&quot;&quot;We accept a few arguments to define our box, and we store them.&quot;&quot;&quot;
        self.x = x
        self.y = y
        self.w = w
        self.h = h

    def __repr__(self):
        &quot;&quot;&quot;This is what is shown if we print a Box. We want it to be useful.&quot;&quot;&quot;
        return 'Box(%s, %s, %s, %s)' % (self.x, self.y, self.w, self.y)

many_boxes = [Box() for i in range(5000)]
</code></pre>
<p>But now, let's organize our boxes in rank and file. In fact, let's put our
many boxes inside a big box.</p>
<pre><code class="language-python">big_box = Box(0,0,50,80) 
</code></pre>
<p>We will get our boxes one at a time, put the first in 0,0 and the next one right at its right, and so on, and when we are about to step outside
of the big box, we go back to the left, a little down, and do it all over again.</p>
<pre><code class="language-python"># We add a &quot;separation&quot; constant so you can see the boxes individually
separation = .2

def layout(_boxes):
    # Because we modify the box list, we will work on a copy
    boxes = _boxes[:]
    # The 1st box is at 0,0 so no need to do anything with it, right?
    previous = boxes.pop(0)
    while boxes:
        # We take the new 1st box
        box = boxes.pop(0)
        # And put it next to the other
        box.x = previous.x + previous.w + separation
        # At the same vertical location
        box.y = previous.y
        # But if it's too far to the right...
        if (box.x + box.w) &gt; big_box.w:
            # We go all the way left and a little down
            box.x = 0
            box.y = previous.y + previous.h + separation
        previous = box

layout(many_boxes)
</code></pre>
<p>And now we can draw it. Just so we are sure we are staying inside the
big box, we will draw it too, in yellow.</p>
<pre><code class="language-python">import svgwrite

def draw_boxes(boxes):
    dwg = svgwrite.Drawing('lesson3.svg', profile='full', size=(100, 100))
    dwg.add(dwg.rect(insert=(big_box.x, big_box.y), 
            size=(big_box.w, big_box.h), fill='yellow'))
    for box in boxes:
        dwg.add(dwg.rect(insert=(box.x, box.y), size=(box.w, box.h), fill='red'))
    dwg.save()

draw_boxes(many_boxes)
</code></pre>
<p>And here is the output:</p>
<p><img src="lesson3.svg" width="100%" style='border: 1px solid green; overflow: auto;'></p>
<p>That is strangely satisfying! Of course we are doing something wrong in that
we are overflowing the big box vertically.</p>
<p>So, we could have more than one big box. And use them as pages?</p>
<a class="header" href="print.html#boxes-v4" id="boxes-v4"><h1>BOXES v4</h1></a>
<p>In the <a href="lesson3.run.html">previous lesson</a> we totally nailed drawing between the lines ... horizontally. Let's improve on that by being bidimensional.</p>
<p>This code is just like before:</p>
<pre><code class="language-python">class Box():
    def __init__(self, x=0, y=0, w=1, h=1):
        &quot;&quot;&quot;We accept a few arguments to define our box, and we store them.&quot;&quot;&quot;
        self.x = x
        self.y = y
        self.w = w
        self.h = h

    def __repr__(self):
        &quot;&quot;&quot;This is what is shown if we print a Box. We want it to be useful.&quot;&quot;&quot;
        return 'Box(%s, %s, %s, %s)' % (self.x, self.y, self.w, self.y)

many_boxes = [Box() for i in range(5000)]
</code></pre>
<p>But now, instead of a big box, let's have a list of, say, 10 pages (or large boxes), one below the other, slighty separated.</p>
<pre><code class="language-python">pages = [Box(0, i * 55, 30, 50) for i in range(10)]
</code></pre>
<p>Of course our layout routine needs improvements to handle overflowing a
page vertically.</p>
<pre><code class="language-python"># We add a &quot;separation&quot; constant so you can see the boxes individually
separation = .2

def layout(_boxes):
    # Because we modify the box list, we will work on a copy
    boxes = _boxes[:]
    # We start at page 0
    page = 0
    # The 1st box should be placed in the correct page
    previous = boxes.pop(0)
    previous.x = pages[page].x
    previous.y = pages[page].y
    while boxes:
        # We take the new 1st box
        box = boxes.pop(0)
        # And put it next to the other
        box.x = previous.x + previous.w + separation
        # At the same vertical location
        box.y = previous.y
        # But if it's too far to the right...
        if (box.x + box.w) &gt; pages[page].x + pages[page].w:
            # We go all the way left and a little down
            box.x = pages[page].x
            box.y = previous.y + previous.h + separation

        # But if we go too far down
        if box.y + box.h &gt; pages[page].y + pages[page].h:
            # We go to the next page
            page += 1
            # And put the box at the top-left
            box.x = pages[page].x
            box.y = pages[page].y

        previous = box

layout(many_boxes)
</code></pre>
<p>And we need to change our drawing code to draw more than one page. Also, because we will run it more than once, I added an argument to choose
the name of the output file.</p>
<pre><code class="language-python">import svgwrite

def draw_boxes(boxes, name='lesson4.svg'):
    dwg = svgwrite.Drawing(name, profile='full', size=(100, 100))
    for page in pages:
        dwg.add(dwg.rect(insert=(page.x, page.y), 
                size=(page.w, page.h), fill='yellow'))
    for box in boxes:
        dwg.add(dwg.rect(insert=(box.x, box.y), size=(box.w, box.h), fill='red'))
    dwg.save()

draw_boxes(many_boxes)
</code></pre>
<p>And here is the output:</p>
<p><img src="lesson4.svg" width="100%" style='border: 1px solid green; overflow: auto;'></p>
<p>Would this work if the pages are arranged differently? Let's put the pages
side by side instead.</p>
<pre><code class="language-python">pages = [Box(i * 35, 0, 30, 50) for i in range(10)]
layout(many_boxes)
draw_boxes(many_boxes, 'lesson4_side_by_side.svg')
</code></pre>
<p><img src="lesson4_side_by_side.svg" width="100%" style='border: 1px solid green; overflow: auto;'></p>
<p>And how about pages of different sizes?</p>
<pre><code class="language-python">from random import randint
pages = [Box(i * 35, 0, 30 + randint(-3,3), 50 + randint(-10, 10)) for i in range(10)]
layout(many_boxes)
draw_boxes(many_boxes, 'lesson4_random_sizes.svg')
</code></pre>
<p><img src="lesson4_random_sizes.svg" width="100%" style='border: 1px solid green; overflow: auto;'></p>
<p>So, we can fill pages and pages with little red squares now. Nice!</p>
<p>How about we make the squares not be all the same width?</p>
<pre><code class="language-python">many_boxes = [Box(w=1 + randint(-5,5)/10) for i in range(5000)]
layout(many_boxes)
draw_boxes(many_boxes, 'lesson4_random_box_sizes.svg')
</code></pre>
<p>This adds &quot;noise&quot; to the width of the boxes, so they are now anything between 0.5 and 1.5 units wide.</p>
<p><img src="lesson4_random_box_sizes.svg" width="100%" style='border: 1px solid green; overflow: auto;'></p>
<p>That looks interesting...</p>
<a class="header" href="print.html#boxes-v5" id="boxes-v5"><h1>BOXES v5</h1></a>
<p>In our <a href="lesson.4.run.html">previous lesson</a> we created code that can fill a series of pages using many small boxes.</p>
<p>But only when those boxes are all alike. Once the boxes had different widths, the right side of our layout got all ragged. You surely have seen things like it when using word processors or reading web pages, where the text is all aligned on the left and all ragged on the right. It's called a &quot;left-aligned&quot; or &quot;ragged-right&quot; layout.</p>
<p>The reason is that we exceed the page width by a random amount, and then,
when moving that box to the next row, we are left a random amount <strong>short</strong> of the desired width.</p>
<p>Could we make it look aligned on BOTH sides? Of course. Let's try.</p>
<p>This code is just like before:</p>
<pre><code class="language-python">class Box():
    def __init__(self, x=0, y=0, w=1, h=1):
        &quot;&quot;&quot;We accept a few arguments to define our box, and we store them.&quot;&quot;&quot;
        self.x = x
        self.y = y
        self.w = w
        self.h = h

    def __repr__(self):
        &quot;&quot;&quot;This is what is shown if we print a Box. We want it to be useful.&quot;&quot;&quot;
        return 'Box(%s, %s, %s, %s)' % (self.x, self.y, self.w, self.y)

# Many boxes with varying widths
from random import randint
many_boxes = [Box(w=1 + randint(-5,5)/10) for i in range(5000)]
# A few pages all the same size
pages = [Box(i * 35, 5, 30, 50) for i in range(10)]
</code></pre>
<p>And of course, we need a new layout function. The plan is this:</p>
<ul>
<li>Organize boxes in rows, like before.</li>
<li>When we are about to go too wide, see how much &quot;slack&quot; is left
between the right side of our last box in the row and the edge of
the page.</li>
<li>Spread that slack by sliding all boxes slightly right so noone notices.</li>
</ul>
<pre><code class="language-python"># We add a &quot;separation&quot; constant so you can see the boxes individually
separation = .2

def layout(_boxes):
    # Because we modify the box list, we will work on a copy
    boxes = _boxes[:]
    # We start at page 0
    page = 0
    # The 1st box should be placed in the correct page
    previous = boxes.pop(0)
    previous.x = pages[page].x
    previous.y = pages[page].y
    row = []
    while boxes:
        # We take the new 1st box
        box = boxes.pop(0)
        # And put it next to the other
        box.x = previous.x + previous.w + separation
        # At the same vertical location
        box.y = previous.y
        # But if it's too far to the right...
        if (box.x + box.w) &gt; (pages[page].x + pages[page].w):
            # We adjust the row
            slack = (pages[page].x + pages[page].w) - (row[-1].x + row[-1].w)
            bump = slack / len(row)
            # The 1st box gets 0 bumps, the 2nd gets 1 and so on
            for i, b in enumerate(row):
                b.x += bump * i
            # We start a new row
            row = []
            # We go all the way left and a little down
            box.x = pages[page].x
            box.y = previous.y + previous.h + separation

        # But if we go too far down
        if box.y + box.h &gt; pages[page].y + pages[page].h:
            # We go to the next page
            page += 1
            # And put the box at the top-left
            box.x = pages[page].x
            box.y = pages[page].y

        # Put the box in the row
        row.append(box)
        previous = box

layout(many_boxes)
</code></pre>
<p>The drawing code needs no changes.</p>
<pre><code class="language-python">import svgwrite

def draw_boxes(boxes, name='lesson5.svg'):
    dwg = svgwrite.Drawing(name, profile='full', size=(150, 60))
    for page in pages:
        dwg.add(dwg.rect(insert=(page.x, page.y), 
                size=(page.w, page.h), fill='yellow'))
    for box in boxes:
        dwg.add(dwg.rect(insert=(box.x, box.y), size=(box.w, box.h), fill='red'))
    dwg.save()

draw_boxes(many_boxes)
</code></pre>
<p><img src="lesson5.svg" width="100%" style='border: 1px solid green; overflow: auto;'></p>
<p>Isn't that nice? If you look at it from afar it looks sort of familiar.
Doesn't it?</p>
<a class="header" href="print.html#boxes-v6" id="boxes-v6"><h1>BOXES v6</h1></a>

                </div>

                <!-- Mobile navigation buttons -->
                

                

            </div>

            

            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <!-- Livereload script (if served using the cli tool) -->
        

        <script src="highlight.js"></script>
        <script src="book.js"></script>
    </body>
</html>
